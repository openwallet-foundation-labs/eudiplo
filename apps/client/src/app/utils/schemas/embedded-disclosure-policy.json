{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "EmbeddedDisclosurePolicy",
  "type": "object",
  "oneOf": [
    {
      "title": "AllowListPolicy",
      "properties": {
        "$schema": {
          "type": "string"
        },
        "policy": {
          "const": "allowList"
        },
        "values": {
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      },
      "required": ["policy", "values"],
      "additionalProperties": false
    },
    {
      "title": "RootOfTrustPolicy",
      "properties": {
        "$schema": {
          "type": "string"
        },
        "policy": {
          "const": "rootOfTrust"
        },
        "values": {
          "type": "string"
        }
      },
      "required": ["policy", "values"],
      "additionalProperties": false
    },
    {
      "title": "AttestationBasedPolicy",
      "properties": {
        "$schema": {
          "type": "string"
        },
        "policy": {
          "const": "attestationBased"
        },
        "values": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/PolicyCredential"
          }
        }
      },
      "required": ["policy", "values"],
      "additionalProperties": false
    },
    {
      "title": "NoneTrustPolicy",
      "properties": {
        "$schema": {
          "type": "string"
        },
        "policy": {
          "const": "none"
        }
      },
      "required": ["policy"],
      "additionalProperties": false
    }
  ],
  "$defs": {
    "PolicyCredential": {
      "type": "object",
      "properties": {
        "claims": {
          "type": "array",
          "description": "claims query, according to: https://openid.net/specs/openid-4-verifiable-presentations-1_0.html#name-claims-query",
          "items": {
            "type": "object"
          }
        },
        "credentials": {
          "type": "array",
          "description": "credentials query, according to: https://openid.net/specs/openid-4-verifiable-presentations-1_0.html#name-credential-query",
          "items": {
            "type": "object",
            "properties": {
              "id": {
                "type": "string"
              },
              "format": {
                "type": "string"
              },
              "meta": {
                "type": "object",
                "additionalProperties": true
              },
              "trusted_authorities": {
                "type": "object",
                "properties": {
                  "type": {
                    "type": "string"
                  },
                  "values": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    }
                  }
                },
                "required": ["type", "values"]
              }
            },
            "required": ["id", "format", "meta", "trusted_authorities"]
          }
        },
        "credential_sets": {
          "type": "array",
          "description": "credential set, according to: https://openid.net/specs/openid-4-verifiable-presentations-1_0.html#name-credential-set-query",
          "items": {
            "type": "object"
          }
        }
      },
      "required": ["credentials"],
      "additionalProperties": false
    }
  }
}
