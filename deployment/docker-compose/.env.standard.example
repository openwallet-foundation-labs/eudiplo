# =============================================================================
# EUDIPLO - Standard Configuration
# =============================================================================
# Profile: standard (docker compose --profile standard up)
# Use case: Staging environments, small production deployments
# Components: PostgreSQL, MinIO (S3), DB-backed key management
# =============================================================================

# Public URL - used for OAuth redirects and OIDC
PUBLIC_URL=http://localhost:3000

# =============================================================================
# Logging
# =============================================================================
LOG_LEVEL=info
LOG_ENABLE_SESSION_LOGGER=false
LOG_ENABLE_HTTP_LOGGER=false

# =============================================================================
# Authentication
# ⚠️  REQUIRED - These have no defaults, application will fail without them!
# Generate secrets: openssl rand -base64 32
# =============================================================================
MASTER_SECRET=your-secret-key-here-minimum-32-characters
AUTH_CLIENT_ID=your-client-id
AUTH_CLIENT_SECRET=your-client-secret

# =============================================================================
# Database: PostgreSQL
# =============================================================================
DB_TYPE=postgres
DB_HOST=postgres
DB_PORT=5432
DB_USERNAME=eudiplo
DB_PASSWORD=changeme-strong-password
DB_DATABASE=eudiplo

# Database Migrations
# Run migrations automatically on startup (default: true)
#DB_MIGRATIONS_RUN=true
# Enable schema synchronization (default: false)
# WARNING: Only use for development, use migrations in production
#DB_SYNCHRONIZE=false

# =============================================================================
# Key Management: Database-backed
# =============================================================================
KM_TYPE=db

# =============================================================================
# Encryption at Rest
# Keys stored in DB are encrypted using key derived from MASTER_SECRET
# For production, consider using external key source (vault/aws/azure)
# so the encryption key is only in RAM, not in environment variables
# See docs: docs/architecture/database.md#encryption-key-sources
# =============================================================================
# ENCRYPTION_KEY_SOURCE=vault
# VAULT_ENCRYPTION_KEY_PATH=secret/data/eudiplo/encryption-key

# =============================================================================
# File Storage: S3 (MinIO)
# =============================================================================
STORAGE_DRIVER=s3
S3_ENDPOINT=http://minio:9000
S3_REGION=us-east-1
S3_ACCESS_KEY_ID=minioadmin
S3_SECRET_ACCESS_KEY=minioadmin
S3_BUCKET=uploads
S3_FORCE_PATH_STYLE=true

# =============================================================================
# MinIO Configuration (for the MinIO container)
# =============================================================================
MINIO_ROOT_USER=minioadmin
MINIO_ROOT_PASSWORD=minioadmin

# =============================================================================
# Monitoring (optional)
# Set to protect /metrics endpoint with Bearer token
# =============================================================================
# METRICS_TOKEN=your-metrics-bearer-token
