# =============================================================================
# EUDIPLO - Full Configuration
# =============================================================================
# Profile: full (docker compose --profile full up)
# Use case: Enterprise production deployments
# Components: PostgreSQL, MinIO (S3), HashiCorp Vault key management
# =============================================================================

# Public URL - used for OAuth redirects and OIDC
PUBLIC_URL=https://eudiplo.example.com

# =============================================================================
# Logging
# =============================================================================
LOG_LEVEL=info
LOG_ENABLE_SESSION_LOGGER=false
LOG_ENABLE_HTTP_LOGGER=false

# =============================================================================
# Authentication
# ⚠️  MUST change these in production!
# Generate secrets: openssl rand -base64 32
# =============================================================================
MASTER_SECRET=your-production-secret-key-minimum-32-characters
AUTH_CLIENT_ID=your-client-id
AUTH_CLIENT_SECRET=your-client-secret

# Optional: External OIDC provider (e.g., Keycloak)
# OIDC=true
# OIDC_INTERNAL_ISSUER_URL=https://your-keycloak.example.com/realms/eudiplo

# =============================================================================
# Database: PostgreSQL
# =============================================================================
DB_TYPE=postgres
DB_HOST=postgres
DB_PORT=5432
DB_USERNAME=eudiplo
DB_PASSWORD=changeme-very-strong-password
DB_DATABASE=eudiplo

# =============================================================================
# Key Management: HashiCorp Vault
# ⚠️  For production, use a properly configured Vault instance
# See: https://developer.hashicorp.com/vault/docs/concepts/seal
# =============================================================================
KM_TYPE=vault
VAULT_ADDR=http://vault:8200
VAULT_TOKEN=root
# For production Vault:
# VAULT_NAMESPACE=eudiplo
# VAULT_MOUNT_PATH=transit
# VAULT_KEY_TYPE=ed25519

# =============================================================================
# Encryption at Rest: Key Source
# ⚠️  For production, use vault/aws/azure so key is only in RAM (not env vars)
# =============================================================================
# Options: env (default, dev only), vault, aws, azure
ENCRYPTION_KEY_SOURCE=vault
# Path to encryption key in Vault KV secrets:
VAULT_ENCRYPTION_KEY_PATH=secret/data/eudiplo/encryption-key
# Create key: vault kv put secret/eudiplo/encryption-key key=$(openssl rand -base64 32)
#
# --- AWS Secrets Manager (alternative) ---
# ENCRYPTION_KEY_SOURCE=aws
# AWS_REGION=us-east-1
# AWS_ENCRYPTION_SECRET_NAME=eudiplo/encryption-key
#
# --- Azure Key Vault (alternative) ---
# ENCRYPTION_KEY_SOURCE=azure
# AZURE_KEYVAULT_URL=https://myvault.vault.azure.net
# AZURE_ENCRYPTION_SECRET_NAME=eudiplo-encryption-key

# =============================================================================
# File Storage: S3 (MinIO or AWS S3)
# =============================================================================
STORAGE_DRIVER=s3
S3_ENDPOINT=http://minio:9000
S3_REGION=us-east-1
S3_ACCESS_KEY_ID=minioadmin
S3_SECRET_ACCESS_KEY=minioadmin
S3_BUCKET=uploads
S3_FORCE_PATH_STYLE=true
# S3_PUBLIC_BASE_URL=https://cdn.example.com/uploads

# =============================================================================
# MinIO Configuration (for the MinIO container)
# =============================================================================
MINIO_ROOT_USER=minioadmin
MINIO_ROOT_PASSWORD=changeme-strong-password
